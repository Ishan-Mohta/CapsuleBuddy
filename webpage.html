            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        .ripple:active::before {
            width: 300px;
            height: 300px;
        }
        .floating { animation: floating 3s ease-in-out infinite; }
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .progress-bar {
            width: 0%;
            transition: width 0.3s ease;
        }
        .notification {
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white p-4 shadow-lg">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="bg-white bg-opacity-20 p-2 rounded-lg">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl font-bold">Capsule Buddy</h1>
                    <p class="text-sm opacity-90">Smart Medicine Tracker</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button id="emergencyBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg font-medium transition-colors">
                    üö® Emergency
                </button>
                <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                    <span class="text-lg">üë§</span>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-6xl mx-auto p-6">
        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <button id="scanBtn" class="bg-white card-shadow p-6 rounded-xl hover:shadow-lg hover:scale-105 hover:glow transition-all duration-300 text-center ripple group">
                <div class="text-3xl mb-2 group-hover:bounce-in">üì±</div>
                <h3 class="font-semibold text-gray-800">Scan Medicine</h3>
                <p class="text-sm text-gray-600">Quick barcode scan</p>
                <div class="mt-2 h-1 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-blue-500 progress-bar" id="scanProgress"></div>
                </div>
            </button>
            <button id="addMedBtn" class="bg-white card-shadow p-6 rounded-xl hover:shadow-lg hover:scale-105 hover:glow transition-all duration-300 text-center ripple group">
                <div class="text-3xl mb-2 group-hover:bounce-in">üíä</div>
                <h3 class="font-semibold text-gray-800">Add Medicine</h3>
                <p class="text-sm text-gray-600">Manual entry</p>
                <div class="mt-2 h-1 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 progress-bar" id="addProgress"></div>
                </div>
            </button>
            <button id="doctorBtn" class="bg-white card-shadow p-6 rounded-xl hover:shadow-lg hover:scale-105 hover:glow transition-all duration-300 text-center ripple group">
                <div class="text-3xl mb-2 group-hover:bounce-in">üë®‚Äç‚öï</div>
                <h3 class="font-semibold text-gray-800">Doctor Connect</h3>
                <p class="text-sm text-gray-600">Share profile</p>
                <div class="mt-2 h-1 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 progress-bar" id="doctorProgress"></div>
                </div>
            </button>
            <button id="profileBtn" class="bg-white card-shadow p-6 rounded-xl hover:shadow-lg hover:scale-105 hover:glow transition-all duration-300 text-center ripple group">
                <div class="text-3xl mb-2 group-hover:bounce-in">üìã</div>
                <h3 class="font-semibold text-gray-800">Health Profile</h3>
                <p class="text-sm text-gray-600">Conditions & allergies</p>
                <div class="mt-2 h-1 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-orange-500 progress-bar" id="profileProgress"></div>
                </div>
            </button>
        </div>

        <!-- Main Content Area -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Today's Medicines -->
            <div class="lg:col-span-2">
                <div class="bg-white card-shadow rounded-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Today's Schedule</h2>
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">3 pending</span>
                    </div>
                    
                    <div id="medicineList" class="space-y-4">
                        <!-- Medicine items will be populated here -->
                    </div>
                </div>
            </div>

            <!-- AI Safety Panel -->
            <div class="space-y-6">
                <!-- Safety Alerts -->
                <div class="bg-white card-shadow rounded-xl p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <span class="text-yellow-500 mr-2">‚ö†</span>
                        AI Safety Check
                    </h3>
                    <div id="safetyAlerts" class="space-y-3">
                        <!-- Safety alerts will be populated here -->
                    </div>
                </div>

                <!-- Health Conditions -->
                <div class="bg-white card-shadow rounded-xl p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Health Conditions</h3>
                    <div id="conditionsList" class="space-y-2">
                        <!-- Conditions will be populated here -->
                    </div>
                    <button id="addConditionBtn" class="w-full mt-4 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors">
                        + Add Condition
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Notifications -->
    <div id="notificationContainer" class="fixed top-20 right-4 z-50 space-y-2">
        <!-- Notifications will appear here -->
    </div>

    <!-- Floating Action Button -->
    <div class="fixed bottom-6 right-6 z-40">
        <button id="floatingBtn" class="bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 floating group">
            <svg class="w-6 h-6 group-hover:rotate-45 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
        </button>
        <div id="fabMenu" class="absolute bottom-16 right-0 space-y-2 opacity-0 transform scale-0 transition-all duration-300">
            <button class="bg-green-500 hover:bg-green-600 text-white p-3 rounded-full shadow-lg block" onclick="quickAddMedicine()">
                <span class="text-sm">üíä</span>
            </button>
            <button class="bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-lg block" onclick="quickScan()">
                <span class="text-sm">üì±</span>
            </button>
            <button class="bg-red-500 hover:bg-red-600 text-white p-3 rounded-full shadow-lg block" onclick="quickEmergency()">
                <span class="text-sm">üö®</span>
            </button>
        </div>
    </div>

    <!-- Modals -->
    <!-- Doctor Connection Modal -->
    <div id="doctorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-2xl mx-4 slide-in">
            <h3 class="text-xl font-bold mb-4">Doctor Connections & Sharing</h3>
            
            <!-- Connected Doctors -->
            <div class="mb-6">
                <h4 class="font-semibold text-gray-800 mb-3">Connected Doctors</h4>
                <div id="doctorList" class="space-y-3">
                    <!-- Doctor connections will be populated here -->
                </div>
            </div>

            <!-- Add New Doctor -->
            <div class="border-t pt-4">
                <h4 class="font-semibold text-gray-800 mb-3">Connect New Doctor</h4>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Doctor's Share Code</label>
                        <input type="text" id="doctorShareCode" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., CB-2024-ABC123">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Access Level</label>
                        <select id="accessLevel" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="full">Full Access</option>
                            <option value="limited">Limited Access</option>
                            <option value="emergency">Emergency Only</option>
                        </select>
                    </div>
                </div>
                <button id="connectDoctor" class="mt-3 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                    Connect Doctor
                </button>
            </div>

            <!-- Your Share Code -->
            <div class="border-t pt-4 mt-4">
                <h4 class="font-semibold text-gray-800 mb-2">Your Patient Share Code</h4>
                <div class="bg-gray-50 rounded-lg p-3 flex items-center justify-between">
                    <code class="text-lg font-mono">CB-2024-PT567</code>
                    <button onclick="copyShareCode()" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm transition-colors">
                        Copy
                    </button>
                </div>
                <p class="text-xs text-gray-600 mt-1">Share this code with your doctor to grant them access to your medicine profile</p>
            </div>

            <div class="flex space-x-3 pt-4">
                <button id="cancelDoctor" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-colors">Close</button>
                <button id="syncAll" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg transition-colors">Sync All</button>
            </div>
        </div>
    </div>

    <!-- Add Medicine Modal -->
    <div id="addMedicineModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4 slide-in">
            <h3 class="text-xl font-bold mb-4">Add New Medicine</h3>
            <form id="addMedicineForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Medicine Name</label>
                    <input type="text" id="medicineName" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Aspirin">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Dosage</label>
                    <input type="text" id="dosage" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., 100mg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Frequency</label>
                    <select id="frequency" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="once">Once daily</option>
                        <option value="twice">Twice daily</option>
                        <option value="thrice">Three times daily</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Time</label>
                    <input type="time" id="medicineTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" id="cancelAddMedicine" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-colors">Cancel</button>
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors">Add Medicine</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Emergency Modal -->
    <div id="emergencyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4 slide-in">
            <h3 class="text-xl font-bold text-red-600 mb-4 flex items-center">
                <span class="mr-2">üö®</span>
                Emergency Medicine Suggestions
            </h3>
            <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
                <p class="text-sm text-red-800"><strong>Disclaimer:</strong> These are AI suggestions only. Contact emergency services or your doctor immediately for serious conditions.</p>
            </div>
            <div id="emergencySymptoms" class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Describe your symptoms:</label>
                <textarea id="symptomsInput" class="w-full border border-gray-300 rounded-lg px-3 py-2 h-20 focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="e.g., headache, fever, nausea..."></textarea>
            </div>
            <div id="emergencySuggestions" class="space-y-3 mb-4">
                <!-- Emergency suggestions will appear here -->
            </div>
            <div class="flex space-x-3">
                <button id="cancelEmergency" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-colors">Close</button>
                <button id="getSuggestions" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors">Get Suggestions</button>
            </div>
        </div>
    </div>

    <!-- Scanner Modal -->
    <div id="scannerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4 slide-in">
            <h3 class="text-xl font-bold mb-4">AI Medicine Scanner</h3>
            
            <!-- Scanner Options -->
            <div class="grid grid-cols-2 gap-4 mb-4">
                <button id="cameraBtn" class="bg-blue-100 hover:bg-blue-200 p-4 rounded-lg text-center transition-colors">
                    <div class="text-2xl mb-2">üì∑</div>
                    <p class="text-sm font-medium">Camera Scan</p>
                    <p class="text-xs text-gray-600">Photo recognition</p>
                </button>
                <button id="textSearchBtn" class="bg-green-100 hover:bg-green-200 p-4 rounded-lg text-center transition-colors">
                    <div class="text-2xl mb-2">üîç</div>
                    <p class="text-sm font-medium">Text Search</p>
                    <p class="text-xs text-gray-600">Type medicine name</p>
                </button>
            </div>

            <!-- Camera Scanner -->
            <div id="cameraScanner" class="hidden">
                <div class="bg-gray-100 rounded-lg p-8 text-center mb-4">
                    <div class="text-6xl mb-4">üì±</div>
                    <p class="text-gray-600 mb-2">Point camera at medicine package</p>
                    <p class="text-xs text-gray-500">AI will recognize text, barcodes, and pill shapes</p>
                    <div class="mt-4 bg-blue-100 border-2 border-dashed border-blue-300 rounded-lg p-4">
                        <div id="scanStatus" class="pulse-animation text-blue-600">ü§ñ AI Processing...</div>
                    </div>
                </div>
            </div>

            <!-- Text Search -->
            <div id="textSearch" class="hidden">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Search Medicine</label>
                        <input type="text" id="medicineSearch" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Type medicine name...">
                    </div>
                    <div id="searchResults" class="space-y-2 max-h-40 overflow-y-auto">
                        <!-- Search results will appear here -->
                    </div>
                </div>
            </div>

            <div class="flex space-x-3 mt-4">
                <button id="cancelScan" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-colors">Cancel</button>
                <button id="manualEntry" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition-colors">Manual Entry</button>
            </div>
        </div>
    </div>

    <script>
        // AI Services Configuration
        const AI_SERVICES = {
            medicationSafety: {
                endpoint: '/api/ai/medication-safety',
                enabled: true
            },
            drugInteractions: {
                endpoint: '/api/ai/drug-interactions',
                enabled: true
            },
            symptomAnalysis: {
                endpoint: '/api/ai/symptom-analysis',
                enabled: true
            },
            imageRecognition: {
                endpoint: '/api/ai/medicine-recognition',
                enabled: true
            }
        };

        // Sample data with enhanced AI analysis
        let medicines = [
            {
                id: 1,
                name: "Metformin",
                dosage: "500mg",
                time: "08:00",
                frequency: "twice",
                taken: false,
                sideEffects: ["Nausea", "Diarrhea"],
                interactions: ["Alcohol"],
                aiSafetyScore: 85,
                conditionCompatibility: ["diabetes"],
                lastAiCheck: new Date().toISOString()
            },
            {
                id: 2,
                name: "Lisinopril",
                dosage: "10mg",
                time: "12:00",
                frequency: "once",
                taken: true,
                sideEffects: ["Dry cough", "Dizziness"],
                interactions: ["Potassium supplements"],
                aiSafetyScore: 92,
                conditionCompatibility: ["hypertension"],
                lastAiCheck: new Date().toISOString()
            },
            {
                id: 3,
                name: "Aspirin",
                dosage: "81mg",
                time: "20:00",
                frequency: "once",
                taken: false,
                sideEffects: ["Stomach irritation"],
                interactions: ["Warfarin", "Alcohol"],
                aiSafetyScore: 78,
                conditionCompatibility: ["cardiovascular"],
                lastAiCheck: new Date().toISOString()
            }
        ];

        let healthConditions = [
            { name: "Type 2 Diabetes", severity: "moderate" },
            { name: "High Blood Pressure", severity: "mild" },
            { name: "High Cholesterol", severity: "mild" }
        ];

        // Doctor-Patient Sharing System
        let doctorConnections = [
            {
                id: 1,
                name: "Dr. Sarah Johnson",
                specialty: "Endocrinology",
                hospital: "City Medical Center",
                accessLevel: "full",
                lastSync: new Date().toISOString(),
                shareCode: "CB-2024-SJ789"
            },
            {
                id: 2,
                name: "Dr. Michael Chen",
                specialty: "Cardiology", 
                hospital: "Heart Institute",
                accessLevel: "limited",
                lastSync: new Date(Date.now() - 86400000).toISOString(),
                shareCode: "CB-2024-MC456"
            }
        ];

        let safetyAlerts = [
            {
                type: "ai_interaction",
                message: "AI detected potential interaction: Aspirin + Alcohol may increase bleeding risk",
                severity: "warning",
                confidence: 94,
                source: "AI Safety Analysis"
            },
            {
                type: "ai_monitoring",
                message: "AI recommends blood glucose monitoring with current Metformin dosage",
                severity: "info",
                confidence: 87,
                source: "AI Health Monitor"
            },
            {
                type: "doctor_alert",
                message: "Dr. Johnson updated your Metformin dosage - check new schedule",
                severity: "info",
                confidence: 100,
                source: "Doctor Update"
            }
        ];

        // Initialize the app
        function init() {
            renderMedicines();
            renderSafetyAlerts();
            renderHealthConditions();
            setupEventListeners();
        }

        function renderMedicines() {
            const container = document.getElementById('medicineList');
            container.innerHTML = medicines.map(med => `
                <div class="border border-gray-200 rounded-lg p-4 ${med.taken ? 'bg-green-50 border-green-200' : 'bg-white'} hover:shadow-lg transition-all duration-300 hover:scale-102 group cursor-pointer" onclick="expandMedicineCard(${med.id})">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl group-hover:bounce-in">${med.taken ? '‚úÖ' : 'üíä'}</div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 flex items-center">
                                        ${med.name}
                                        <span class="ml-2 px-2 py-1 text-xs rounded-full transition-all duration-300 ${
                                            med.aiSafetyScore >= 90 ? 'bg-green-100 text-green-800 group-hover:bg-green-200' :
                                            med.aiSafetyScore >= 80 ? 'bg-yellow-100 text-yellow-800 group-hover:bg-yellow-200' :
                                            'bg-red-100 text-red-800 group-hover:bg-red-200'
                                        }">
                                            AI: ${med.aiSafetyScore}%
                                        </span>
                                    </h4>
                                    <p class="text-sm text-gray-600">${med.dosage} at ${med.time}</p>
                                    <div class="mt-1 h-1 bg-gray-200 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 transition-all duration-500" style="width: ${med.aiSafetyScore}%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="event.stopPropagation(); runAISafetyCheck(${med.id})" class="bg-blue-100 hover:bg-blue-200 text-blue-800 px-3 py-1 rounded text-xs transition-all duration-300 hover:scale-105 ripple">
                                ü§ñ AI Check
                            </button>
                            ${!med.taken ? `
                                <button onclick="event.stopPropagation(); takeMedicine(${med.id})" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition-all duration-300 hover:scale-105 ripple pulse-animation">
                                    Take Now
                                </button>
                            ` : `
                                <span class="text-green-600 text-sm font-medium bounce-in">‚úì Taken</span>
                            `}
                            <button onclick="event.stopPropagation(); showMedicineDetails(${med.id})" class="text-blue-600 hover:text-blue-800 text-sm transition-colors">
                                Details
                            </button>
                        </div>
                    </div>
                    <div id="medicineDetails${med.id}" class="mt-3 overflow-hidden transition-all duration-300" style="max-height: 0;">
                        ${med.sideEffects.length > 0 ? `
                            <div class="text-xs text-gray-500 mb-2">
                                <strong>Side effects:</strong> ${med.sideEffects.join(', ')}
                            </div>
                        ` : ''}
                        <div class="text-xs text-gray-400">
                            Last AI check: ${new Date(med.lastAiCheck).toLocaleString()}
                        </div>
                        <div class="mt-2 flex space-x-2">
                            <button onclick="event.stopPropagation(); editMedicine(${med.id})" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs transition-colors">
                                Edit
                            </button>
                            <button onclick="event.stopPropagation(); setReminder(${med.id})" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-2 py-1 rounded text-xs transition-colors">
                                Remind
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderSafetyAlerts() {
            const container = document.getElementById('safetyAlerts');
            container.innerHTML = safetyAlerts.map(alert => `
                <div class="border-l-4 ${alert.severity === 'warning' ? 'border-yellow-400 bg-yellow-50' : 'border-blue-400 bg-blue-50'} p-3 rounded">
                    <div class="flex items-start justify-between">
                        <p class="text-sm ${alert.severity === 'warning' ? 'text-yellow-800' : 'text-blue-800'} flex-1">${alert.message}</p>
                        <div class="ml-2 text-xs">
                            <span class="px-2 py-1 rounded-full ${
                                alert.confidence >= 90 ? 'bg-green-100 text-green-700' :
                                alert.confidence >= 70 ? 'bg-yellow-100 text-yellow-700' :
                                'bg-red-100 text-red-700'
                            }">
                                ${alert.confidence}%
                            </span>
                        </div>
                    </div>
                    <p class="text-xs ${alert.severity === 'warning' ? 'text-yellow-600' : 'text-blue-600'} mt-1">
                        Source: ${alert.source}
                    </p>
                </div>
            `).join('');
        }

        function renderHealthConditions() {
            const container = document.getElementById('conditionsList');
            container.innerHTML = healthConditions.map(condition => `
                <div class="flex items-center justify-between p-2 bg-gray-50 rounded-lg">
                    <span class="text-sm text-gray-700">${condition.name}</span>
                    <span class="text-xs px-2 py-1 rounded-full ${
                        condition.severity === 'mild' ? 'bg-green-100 text-green-800' :
                        condition.severity === 'moderate' ? 'bg-yellow-100 text-yellow-800' :
                        'bg-red-100 text-red-800'
                    }">${condition.severity}</span>
                </div>
            `).join('');
        }

        function setupEventListeners() {
            // Modal controls
            document.getElementById('addMedBtn').addEventListener('click', () => {
                document.getElementById('addMedicineModal').classList.remove('hidden');
                document.getElementById('addMedicineModal').classList.add('flex');
            });

            document.getElementById('cancelAddMedicine').addEventListener('click', () => {
                document.getElementById('addMedicineModal').classList.add('hidden');
                document.getElementById('addMedicineModal').classList.remove('flex');
            });

            document.getElementById('emergencyBtn').addEventListener('click', () => {
                document.getElementById('emergencyModal').classList.remove('hidden');
                document.getElementById('emergencyModal').classList.add('flex');
            });

            document.getElementById('cancelEmergency').addEventListener('click', () => {
                document.getElementById('emergencyModal').classList.add('hidden');
                document.getElementById('emergencyModal').classList.remove('flex');
            });

            document.getElementById('scanBtn').addEventListener('click', () => {
                document.getElementById('scannerModal').classList.remove('hidden');
                document.getElementById('scannerModal').classList.add('flex');
                // Simulate scan completion after 3 seconds
                setTimeout(() => {
                    document.getElementById('scannerModal').classList.add('hidden');
                    document.getElementById('scannerModal').classList.remove('flex');
                    alert('Medicine scanned: Ibuprofen 200mg\nAdded to your profile!');
                }, 3000);
            });

            document.getElementById('cancelScan').addEventListener('click', () => {
                document.getElementById('scannerModal').classList.add('hidden');
                document.getElementById('scannerModal').classList.remove('flex');
            });

            // Form submission
            document.getElementById('addMedicineForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const newMedicine = {
                    id: medicines.length + 1,
                    name: document.getElementById('medicineName').value,
                    dosage: document.getElementById('dosage').value,
                    time: document.getElementById('medicineTime').value,
                    frequency: document.getElementById('frequency').value,
                    taken: false,
                    sideEffects: [],
                    interactions: []
                };
                medicines.push(newMedicine);
                renderMedicines();
                document.getElementById('addMedicineModal').classList.add('hidden');
                document.getElementById('addMedicineModal').classList.remove('flex');
                document.getElementById('addMedicineForm').reset();
            });

            // Emergency suggestions
            document.getElementById('getSuggestions').addEventListener('click', () => {
                const symptoms = document.getElementById('symptomsInput').value;
                if (symptoms.trim()) {
                    showEmergencySuggestions(symptoms);
                }
            });

            // Doctor connect
            document.getElementById('doctorBtn').addEventListener('click', () => {
                document.getElementById('doctorModal').classList.remove('hidden');
                document.getElementById('doctorModal').classList.add('flex');
                renderDoctorConnections();
            });

            document.getElementById('cancelDoctor').addEventListener('click', () => {
                document.getElementById('doctorModal').classList.add('hidden');
                document.getElementById('doctorModal').classList.remove('flex');
            });

            // Scanner enhancements
            document.getElementById('cameraBtn').addEventListener('click', () => {
                document.getElementById('cameraScanner').classList.remove('hidden');
                document.getElementById('textSearch').classList.add('hidden');
                simulateAIImageRecognition();
            });

            document.getElementById('textSearchBtn').addEventListener('click', () => {
                document.getElementById('textSearch').classList.remove('hidden');
                document.getElementById('cameraScanner').classList.add('hidden');
            });

            document.getElementById('medicineSearch').addEventListener('input', (e) => {
                performMedicineSearch(e.target.value);
            });

            document.getElementById('manualEntry').addEventListener('click', () => {
                document.getElementById('scannerModal').classList.add('hidden');
                document.getElementById('scannerModal').classList.remove('flex');
                document.getElementById('addMedicineModal').classList.remove('hidden');
                document.getElementById('addMedicineModal').classList.add('flex');
            });

            // Connect doctor
            document.getElementById('connectDoctor').addEventListener('click', () => {
                const shareCode = document.getElementById('doctorShareCode').value;
                const accessLevel = document.getElementById('accessLevel').value;
                if (shareCode) {
                    connectNewDoctor(shareCode, accessLevel);
                }
            });

            // Health profile
            document.getElementById('profileBtn').addEventListener('click', () => {
                alert('Health Profile:\n\n‚Ä¢ Current conditions: ' + healthConditions.map(c => c.name).join(', ') + '\n‚Ä¢ Allergies: None recorded\n‚Ä¢ Emergency contacts: 2 added\n‚Ä¢ Insurance info: On file\n\nClick "Add Condition" to update your profile.');
            });
        }

        function takeMedicine(id) {
            const medicine = medicines.find(m => m.id === id);
            if (medicine) {
                // Show confirmation animation
                showNotification(Taking ${medicine.name}..., 'info');
                
                // Animate the medicine card
                const medicineCard = document.querySelector([onclick*="expandMedicineCard(${id})"]);
                if (medicineCard) {
                    medicineCard.classList.add('bounce-in');
                }
                
                setTimeout(() => {
                    medicine.taken = true;
                    renderMedicines();
                    showNotification(‚úÖ ${medicine.name} taken successfully!, 'success');
                    
                    // AI safety check after taking medicine
                    setTimeout(() => {
                        const newAlert = {
                            type: "taken",
                            message: ${medicine.name} taken successfully. Monitor for side effects: ${medicine.sideEffects.join(', ')},
                            severity: "info",
                            confidence: 95,
                            source: "Medicine Tracker"
                        };
                        safetyAlerts.unshift(newAlert);
                        renderSafetyAlerts();
                    }, 1000);
                }, 800);
            }
        }

        function showMedicineDetails(id) {
            const medicine = medicines.find(m => m.id === id);
            if (medicine) {
                alert(Medicine Details:\n\nName: ${medicine.name}\nDosage: ${medicine.dosage}\nFrequency: ${medicine.frequency} daily\nTime: ${medicine.time}\n\nSide Effects:\n${medicine.sideEffects.join('\n')}\n\nInteractions:\n${medicine.interactions.join('\n')}\n\nStatus: ${medicine.taken ? 'Taken today' : 'Pending'});
            }
        }

        function showEmergencySuggestions(symptoms) {
            const container = document.getElementById('emergencySuggestions');
            
            // Enhanced AI symptom analysis
            const aiAnalysis = analyzeSymptoms(symptoms);
            let suggestions = [];
            
            // AI-driven suggestions based on symptoms and health profile
            aiAnalysis.conditions.forEach(condition => {
                const safeMeds = getSafeMedicationsForCondition(condition, healthConditions);
                suggestions.push(...safeMeds);
            });
            
            if (suggestions.length === 0) {
                suggestions.push({
                    medicine: 'No safe recommendations found',
                    dosage: 'Contact healthcare provider immediately',
                    warning: 'AI analysis suggests professional medical evaluation needed',
                    confidence: 95,
                    aiReasoning: 'Symptoms may indicate serious condition requiring immediate medical attention'
                });
            }
            
            container.innerHTML = `
                <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <h5 class="font-semibold text-blue-800 text-sm">ü§ñ AI Analysis Results</h5>
                    <p class="text-xs text-blue-700 mt-1">
                        Detected conditions: ${aiAnalysis.conditions.join(', ') || 'None specific'}<br>
                        Confidence: ${aiAnalysis.confidence}% | Risk Level: ${aiAnalysis.riskLevel}
                    </p>
                </div>
                ${suggestions.map(suggestion => `
                    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50 mb-3">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">${suggestion.medicine}</h4>
                                <p class="text-sm text-gray-600 mt-1">Dosage: ${suggestion.dosage}</p>
                                <p class="text-xs text-orange-600 mt-2">‚ö† ${suggestion.warning}</p>
                                ${suggestion.aiReasoning ? `
                                    <p class="text-xs text-blue-600 mt-1 italic">AI: ${suggestion.aiReasoning}</p>
                                ` : ''}
                            </div>
                            <span class="ml-2 px-2 py-1 text-xs rounded-full ${
                                suggestion.confidence >= 80 ? 'bg-green-100 text-green-700' :
                                suggestion.confidence >= 60 ? 'bg-yellow-100 text-yellow-700' :
                                'bg-red-100 text-red-700'
                            }">
                                ${suggestion.confidence || 'N/A'}%
                            </span>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // AI Analysis Functions
        function analyzeSymptoms(symptoms) {
            const lowerSymptoms = symptoms.toLowerCase();
            let conditions = [];
            let confidence = 70;
            let riskLevel = 'low';
            
            // Symptom pattern matching
            if (lowerSymptoms.includes('chest pain') || lowerSymptoms.includes('heart')) {
                conditions.push('cardiovascular emergency');
                confidence = 95;
                riskLevel = 'high';
            } else if (lowerSymptoms.includes('headache') && lowerSymptoms.includes('severe')) {
                conditions.push('severe headache');
                confidence = 85;
                riskLevel = 'medium';
            } else if (lowerSymptoms.includes('fever') && lowerSymptoms.includes('high')) {
                conditions.push('high fever');
                confidence = 90;
                riskLevel = 'medium';
            } else if (lowerSymptoms.includes('pain')) {
                conditions.push('pain management');
                confidence = 75;
            } else if (lowerSymptoms.includes('nausea') || lowerSymptoms.includes('vomit')) {
                conditions.push('gastrointestinal distress');
                confidence = 80;
            }
            
            return { conditions, confidence, riskLevel };
        }

        function getSafeMedicationsForCondition(condition, userConditions) {
            const medications = [];
            
            switch (condition) {
                case 'pain management':
                    if (!userConditions.some(c => c.name.includes('liver'))) {
                        medications.push({
                            medicine: 'Acetaminophen (Tylenol)',
                            dosage: '500-1000mg every 4-6 hours (max 3000mg/day)',
                            warning: 'Safe with your current health conditions',
                            confidence: 88,
                            aiReasoning: 'Safest pain reliever for your health profile'
                        });
                    }
                    break;
                case 'high fever':
                    medications.push({
                        medicine: 'Ibuprofen + Cooling measures',
                        dosage: '400mg every 6 hours + cold compress',
                        warning: 'Monitor blood pressure if you have hypertension',
                        confidence: 82,
                        aiReasoning: 'Effective fever reducer, but requires BP monitoring'
                    });
                    break;
                case 'gastrointestinal distress':
                    medications.push({
                        medicine: 'Oral rehydration solution',
                        dosage: 'Small sips every 15 minutes',
                        warning: 'Avoid solid foods until symptoms improve',
                        confidence: 90,
                        aiReasoning: 'Prevents dehydration, safe for all conditions'
                    });
                    break;
                case 'cardiovascular emergency':
                    medications.push({
                        medicine: 'Call 911 immediately',
                        dosage: 'Emergency services required',
                        warning: 'Do not take any medications - seek immediate medical care',
                        confidence: 99,
                        aiReasoning: 'Chest pain requires immediate professional evaluation'
                    });
                    break;
            }
            
            return medications;
        }

        // Additional AI and Sharing Functions
        function runAISafetyCheck(medicineId) {
            const medicine = medicines.find(m => m.id === medicineId);
            if (!medicine) return;
            
            // Simulate AI safety analysis
            const analysisResult = performAISafetyAnalysis(medicine);
            medicine.aiSafetyScore = analysisResult.score;
            medicine.lastAiCheck = new Date().toISOString();
            
            // Add new safety alert if issues found
            if (analysisResult.alerts.length > 0) {
                safetyAlerts.unshift(...analysisResult.alerts);
                renderSafetyAlerts();
            }
            
            renderMedicines();
            alert(AI Safety Check Complete!\n\nSafety Score: ${analysisResult.score}%\n${analysisResult.summary});
        }

        function performAISafetyAnalysis(medicine) {
            let score = 100;
            let alerts = [];
            let issues = [];
            
            // Check interactions with other medicines
            medicines.forEach(otherMed => {
                if (otherMed.id !== medicine.id) {
                    if (medicine.interactions.some(interaction => 
                        otherMed.name.toLowerCase().includes(interaction.toLowerCase()))) {
                        score -= 15;
                        issues.push(Potential interaction with ${otherMed.name});
                        alerts.push({
                            type: "ai_interaction",
                            message: AI detected interaction risk: ${medicine.name} + ${otherMed.name},
                            severity: "warning",
                            confidence: 87,
                            source: "AI Drug Interaction Analysis"
                        });
                    }
                }
            });
            
            // Check compatibility with health conditions
            const incompatibleConditions = healthConditions.filter(condition => {
                return !medicine.conditionCompatibility.some(compat => 
                    condition.name.toLowerCase().includes(compat));
            });
            
            if (incompatibleConditions.length > 0) {
                score -= 10;
                issues.push(May not be optimal for ${incompatibleConditions[0].name});
            }
            
            const summary = issues.length > 0 ? 
                Issues found: ${issues.join(', ')} : 
                'No safety concerns detected';
            
            return { score: Math.max(score, 0), alerts, summary };
        }

        function renderDoctorConnections() {
            const container = document.getElementById('doctorList');
            container.innerHTML = doctorConnections.map(doctor => `
                <div class="border border-gray-200 rounded-lg p-4 bg-white">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h5 class="font-semibold text-gray-800">${doctor.name}</h5>
                            <p class="text-sm text-gray-600">${doctor.specialty} ‚Ä¢ ${doctor.hospital}</p>
                            <p class="text-xs text-gray-500">Access: ${doctor.accessLevel} ‚Ä¢ Last sync: ${new Date(doctor.lastSync).toLocaleDateString()}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs rounded-full ${
                                new Date() - new Date(doctor.lastSync) < 86400000 ? 
                                'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'
                            }">
                                ${new Date() - new Date(doctor.lastSync) < 86400000 ? 'Synced' : 'Pending'}
                            </span>
                            <button onclick="syncWithDoctor(${doctor.id})" class="text-blue-600 hover:text-blue-800 text-sm">
                                Sync
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function connectNewDoctor(shareCode, accessLevel) {
            // Simulate doctor connection
            const newDoctor = {
                id: doctorConnections.length + 1,
                name: "Dr. " + shareCode.split('-')[2],
                specialty: "General Medicine",
                hospital: "Connected via share code",
                accessLevel: accessLevel,
                lastSync: new Date().toISOString(),
                shareCode: shareCode
            };
            
            doctorConnections.push(newDoctor);
            renderDoctorConnections();
            document.getElementById('doctorShareCode').value = '';
            
            alert(Successfully connected to ${newDoctor.name}!\nAccess level: ${accessLevel});
        }

        function syncWithDoctor(doctorId) {
            const doctor = doctorConnections.find(d => d.id === doctorId);
            if (doctor) {
                doctor.lastSync = new Date().toISOString();
                renderDoctorConnections();
                alert(Synced with ${doctor.name}!\n\nShared data:\n‚Ä¢ Current medications\n‚Ä¢ Health conditions\n‚Ä¢ Recent AI safety alerts\n‚Ä¢ Medication adherence);
            }
        }

        function simulateAIImageRecognition() {
            const statusElement = document.getElementById('scanStatus');
            const steps = [
                'ü§ñ AI Processing image...',
                'üìù Extracting text from package...',
                'üîç Identifying medicine name...',
                'üíä Looking up drug information...',
                '‚úÖ Medicine identified!'
            ];
            
            let stepIndex = 0;
            const interval = setInterval(() => {
                statusElement.textContent = steps[stepIndex];
                stepIndex++;
                
                if (stepIndex >= steps.length) {
                    clearInterval(interval);
                    setTimeout(() => {
                        document.getElementById('scannerModal').classList.add('hidden');
                        document.getElementById('scannerModal').classList.remove('flex');
                        alert('AI Image Recognition Results:\n\nMedicine: Ibuprofen 200mg\nManufacturer: Generic\nExpiry: 12/2025\n\nWould you like to add this to your profile?');
                    }, 1000);
                }
            }, 800);
        }

        function performMedicineSearch(query) {
            const container = document.getElementById('searchResults');
            if (!query.trim()) {
                container.innerHTML = '';
                return;
            }
            
            // Simulate medicine database search
            const medicines = [
                'Acetaminophen 500mg', 'Ibuprofen 200mg', 'Aspirin 81mg',
                'Metformin 500mg', 'Lisinopril 10mg', 'Atorvastatin 20mg',
                'Omeprazole 20mg', 'Levothyroxine 50mcg', 'Amlodipine 5mg'
            ];
            
            const results = medicines.filter(med => 
                med.toLowerCase().includes(query.toLowerCase())
            );
            
            container.innerHTML = results.map(result => `
                <div class="border border-gray-200 rounded p-2 hover:bg-gray-50 cursor-pointer" onclick="selectMedicine('${result}')">
                    <p class="text-sm font-medium">${result}</p>
                </div>
            `).join('');
        }

        function selectMedicine(medicineName) {
            document.getElementById('scannerModal').classList.add('hidden');
            document.getElementById('scannerModal').classList.remove('flex');
            document.getElementById('addMedicineModal').classList.remove('hidden');
            document.getElementById('addMedicineModal').classList.add('flex');
            document.getElementById('medicineName').value = medicineName.split(' ')[0];
            document.getElementById('dosage').value = medicineName.split(' ')[1] || '';
        }

        function copyShareCode() {
            navigator.clipboard.writeText('CB-2024-PT567').then(() => {
                alert('Share code copied to clipboard!');
            });
        }

        // Interactive Functions
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification bg-white border-l-4 ${
                type === 'success' ? 'border-green-500' : 
                type === 'error' ? 'border-red-500' : 
                type === 'warning' ? 'border-yellow-500' : 'border-blue-500'
            } p-4 rounded-lg shadow-lg max-w-sm`;
            
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <p class="text-sm text-gray-800">${message}</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            container.appendChild(notification);
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function expandMedicineCard(id) {
            const detailsElement = document.getElementById(medicineDetails${id});
            const isExpanded = detailsElement.style.maxHeight !== '0px';
            
            // Close all other expanded cards
            medicines.forEach(med => {
                if (med.id !== id) {
                    const otherDetails = document.getElementById(medicineDetails${med.id});
                    if (otherDetails) {
                        otherDetails.style.maxHeight = '0px';
                    }
                }
            });
            
            // Toggle current card
            if (isExpanded) {
                detailsElement.style.maxHeight = '0px';
            } else {
                detailsElement.style.maxHeight = detailsElement.scrollHeight + 'px';
            }
        }

        function animateProgressBar(elementId, targetWidth) {
            const element = document.getElementById(elementId);
            if (element) {
                element.style.width = targetWidth + '%';
            }
        }

        function quickAddMedicine() {
            animateProgressBar('addProgress', 100);
            setTimeout(() => {
                document.getElementById('addMedicineModal').classList.remove('hidden');
                document.getElementById('addMedicineModal').classList.add('flex');
                animateProgressBar('addProgress', 0);
            }, 500);
        }

        function quickScan() {
            animateProgressBar('scanProgress', 100);
            setTimeout(() => {
                document.getElementById('scannerModal').classList.remove('hidden');
                document.getElementById('scannerModal').classList.add('flex');
                animateProgressBar('scanProgress', 0);
            }, 500);
        }

        function quickEmergency() {
            document.getElementById('emergencyModal').classList.remove('hidden');
            document.getElementById('emergencyModal').classList.add('flex');
            showNotification('Emergency mode activated!', 'warning');
        }

        function editMedicine(id) {
            const medicine = medicines.find(m => m.id === id);
            if (medicine) {
                showNotification(Editing ${medicine.name}..., 'info');
                // Open edit modal with pre-filled data
                document.getElementById('addMedicineModal').classList.remove('hidden');
                document.getElementById('addMedicineModal').classList.add('flex');
                document.getElementById('medicineName').value = medicine.name;
                document.getElementById('dosage').value = medicine.dosage;
                document.getElementById('medicineTime').value = medicine.time;
                document.getElementById('frequency').value = medicine.frequency;
            }
        }

        function setReminder(id) {
            const medicine = medicines.find(m => m.id === id);
            if (medicine) {
                showNotification(Reminder set for ${medicine.name} at ${medicine.time}, 'success');
            }
        }

        // Floating Action Button
        let fabMenuOpen = false;
        document.getElementById('floatingBtn').addEventListener('click', () => {
            const menu = document.getElementById('fabMenu');
            fabMenuOpen = !fabMenuOpen;
            
            if (fabMenuOpen) {
                menu.classList.remove('opacity-0', 'scale-0');
                menu.classList.add('opacity-100', 'scale-100');
            } else {
                menu.classList.add('opacity-0', 'scale-0');
                menu.classList.remove('opacity-100', 'scale-100');
            }
        });

        // Enhanced button interactions
        function setupInteractiveButtons() {
            // Add click animations to all buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function(e) {
                    // Create ripple effect
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;
                    
                    ripple.style.width = ripple.style.height = size + 'px';
                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';
                    ripple.classList.add('ripple-effect');
                    
                    this.appendChild(ripple);
                    
                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });
            });
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            init();
            setupInteractiveButtons();
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('Welcome to Capsule Buddy! üíä', 'success');
            }, 1000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97cf286447af8a1a',t:'MTc1NzUwOTc0NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
